
#include	<string.h>
#include	"video.h"
#include    "..\common\common.h"

#if defined(__NVP1918C_TX__)

static ROMDATA BYTE NTSC_720H_B4_Normal_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x08,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x84,0x84,0x05,0x01,0x00,0x01,0x84,0x00,
	/*9*/   0x00,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE NTSC_960H_B4_Normal_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x0A,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x84,0x84,0x05,0x01,0x00,0x01,0x84,0x00,
	/*9*/   0x00,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE PAL_720H_B4_Normal_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x09,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x84,0x84,0x05,0x13,0x00,0x03,0x84,0x00,
	/*9*/   0x40,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE PAL_960H_B4_Normal_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x0B,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x84,0x84,0x05,0x13,0x00,0x03,0x84,0x00,
	/*9*/   0x40,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE NTSC_720H_B4_COMET_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x08,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x8E,0x8E,0x05,0x51,0x00,0x01,0x8E,0x00,
	/*9*/   0x00,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE NTSC_960H_B4_COMET_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x0A,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x8E,0x8E,0x05,0x51,0x00,0x01,0x8E,0x00,
	/*9*/   0x00,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE PAL_720H_B4_COMET_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x09,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x8E,0x8E,0x05,0x73,0x00,0x03,0x8E,0x00,
	/*9*/   0x40,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

static ROMDATA BYTE PAL_960H_B4_COMET_Buf[] = {
	//	    0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
	/*8*/   0x0B,0x00,0x00,0x08,0x08,0x7E,0x00,0x82,0x8E,0x8E,0x05,0x73,0x00,0x03,0x8E,0x00,
	/*9*/   0x40,0x73,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};



static void NVP1918C_EncoderInitial(PNCDEC_INFO pINFO)
{
	NVP1918C_RegWrite( 0xFF , BANK1);
	NVP1918C_RegWrite( 0x45 , 0x11);
	NVP1918C_RegWrite( 0x46 , 0x10);
	NVP1918C_RegWrite( 0x4A , 0x22);
	NVP1918C_RegWrite( 0x4B , 0x20);
	NVP1918C_RegWrite( 0x48 , 0x61);	
	MDINDLY_mSec(10);
	NVP1918C_RegWrite( 0x48 , 0x60);
	MDINDLY_mSec(20);

	NVP1918C_RegWrite( 0xFF , BANK0);
	NVP1918C_RegWrite( 0x02 , 0x20);

	NVP1918C_RegWrite( 0xFF , BANK4);

	if(pINFO->tx.comet == ON)
	{
		if (pINFO->vformat == NTSC)
			NVP1918C_MultiWrite(0x80, (pINFO->tx.enc_resol == NC_ENCSRC_960X480) ?(PBYTE)NTSC_960H_B4_COMET_Buf : (PBYTE)NTSC_720H_B4_COMET_Buf, 32);
		else
			NVP1918C_MultiWrite(0x80, (pINFO->tx.enc_resol == NC_ENCSRC_960X576) ? (PBYTE)PAL_960H_B4_COMET_Buf : (PBYTE)PAL_720H_B4_COMET_Buf, 32);
	}
	else 
	{
		if (pINFO->vformat == NTSC)
			NVP1918C_MultiWrite(0x80, (pINFO->tx.enc_resol == NC_ENCSRC_960X480) ? (PBYTE)NTSC_960H_B4_Normal_Buf : (PBYTE)NTSC_720H_B4_Normal_Buf, 32);
		else
			NVP1918C_MultiWrite(0x80, (pINFO->tx.enc_resol == NC_ENCSRC_960X576) ? (PBYTE)PAL_960H_B4_Normal_Buf : (PBYTE)PAL_720H_B4_Normal_Buf, 32);
	} 
}

void DecoderInitial(PNCDEC_INFO pINFO)
{
	VDEC_RST(LOW);
	MDINDLY_mSec(20);
	VDEC_RST(HIGH);
	MDINDLY_mSec(20);

	printf("\r\nNVP1918C TX Initialing...");
	NVP1918C_EncoderInitial(pINFO);
	printf("OK\r\n");
}

#endif

